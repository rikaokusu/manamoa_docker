{% extends "common/base.html" %}
{% load i18n static %}
{% load is_exists %}
{% load get_file_id_value %}
{% load zfill %}
{% load get_model_obj %}
{% load get_co_admin_user %}
{% load get_training_reguser_display_name %}
{% load get_training_reguser_company_pic_dept_name %}

{% block title %}トレーニング詳細設定 | {{ block.super }}{% endblock %}

{% block content %}

<!-- bootstrap-duallistbox -->
{% comment %} <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap4-duallistbox/4.0.2/bootstrap-duallistbox.css" rel="stylesheet" type="text/css"  /> {% endcomment %}
<link rel="stylesheet" href="{% static 'training/css/bootstrap-duallistbox.css' %}">


<style>
    /*---------------------------------

    ツールチップ

    ---------------------------------*/
    .tooltip-inner{
        max-width: 100%;
    }

    /*---------------------------------

        タイトル

    ---------------------------------*/

    .training_title {
        padding: 0.25em 0.5em;/*上下 左右の余白*/
        color: #494949;/*文字色*/
        background: transparent;/*背景透明に*/
        border-left: solid 10px #7db4e6;/*左線*/
        margin-top: 20px;
        font-weight: bold;
        font-size: 25px;
    }

    .parts_add_btn {
        font-size: 20px;
    }

    .training_create_btn {
        width: 6rem;
        height: 3.5rem;
    }

    .my_btn_text {
        font-size: 14px;
    }

    .fa-plus-circle.fa-w-16 {
        color: #f15f3e;
    }

    /*---------------------------------

        ラベル

    ---------------------------------*/

    span.label {
        line-height: 1.6;
        font-size: 1em;
        margin: 10px 0;
        font-weight: 700;
        vertical-align: text-bottom;
        color: #fff;
        padding: 5px 14px;
        -webkit-box-shadow: none;
        box-shadow: none;
        background-color: #0d94ec;
    }

    /* 共同管理者用のラベル */
    span.label_co_admin_user {
        line-height: 1.6;
        font-size: 1em;
        margin: 10px 0;
        font-weight: 700;
        vertical-align: text-bottom;
        color: #fff;
        padding: 5px 14px;
        -webkit-box-shadow: none;
        box-shadow: none;
        background-color: #ff794f;
    }

    /*---------------------------------

        画面の幅

    ---------------------------------*/

    .row {
        margin: auto;
        justify-content: center; /*外枠の上下左右中央寄せ*/
    }


    .container-fluid {
        padding-right: 40px;
        padding-left: 40px;
    }





    .training_card .remark {
        display: none;
    }
    .training_card:hover .remark {
        background: none repeat scroll 0 0 #f9f9f9;
        border: 1px solid #f9f9f9;
        border-radius: 5px;
        box-shadow: 0 0.0625em 0.125em rgb(0 0 0 / 30%);
        color: #343a40;
        display: block;
        line-height: 1.2em;
        padding: 15px;
        position: absolute;
        top: -47px;
        left: 91%;
        width: 105px;
        height: 45px;
    }


    .menu_box {
        cursor: pointer;
        display: inline;
    }

    /*---------------------------------

        bootstrap-duallistbox

    ---------------------------------*/

    .bootstrap-duallistbox-container select {
        width: 100%;
        height: 250px;
        border: 1px solid #ced4da;
        padding: 0;
    }

    .bootstrap-duallistbox-container label {
        font-weight: bold;
        color: #494949;
    }

    .moveall,
    .removeall {
        border: 1px solid #ced4da !important;
        color: #808080;
    }

    .buttons > .btn i + i{
        display:none;
    }


/*---------------------------------

    パーツを追加するのボタン

---------------------------------*/


    .fas_button_parts_add {
        display: block;
        position: relative;
        border: 2px solid #7cb4e6;
        width: 280px;
        padding: 15px;
        border-radius: 10px;
        text-align: center;
        text-decoration: none;
        font-weight: bold;
        letter-spacing: .1rem;
        background-color: #fff;
        cursor: pointer;
    }

    .fas_button_parts_add:before {
        position: absolute;
        top: 15%;
        left: 15px;
        width: 10px;
        color: #7cb4e6;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\2b';
        font-size: 22px;
    }

    .fas_button_parts_add:hover {
        background: #7cb4e6;
        color: #fff;
    }

    .fas_button_parts_add:hover:before {
        position: absolute;
        top: 15%;
        left: 15px;
        width: 10px;
        color: #fff;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\2b';
        font-size: 22px;
    }

    /* パーツ追加ボタンが無効の場合 */
    .button-wrapper .fas_button_parts_add:disabled{
        pointer-events:none;
        opacity: 0.55;
    }

    .training_copy_btn {
        border: none;
        border-radius: 10px;
        padding: 10px 24px;;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        background-color: #e7e7e7;
        color: black;
        transition-duration: 0.4s;
    }

    .training_copy_btn:hover {
        background-color: #a5a5a5;
        color: white;
    }

    .training_copy_btn:before{
        {% comment %} line-height: 50px; {% endcomment %}
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        {% comment %} font-weight: 900; {% endcomment %}
        content: '\f0c5';
        font-size: 17px;
    }

    /* パーツ追加ボタンが無効の場合 */
    .button-wrapper .training_copy_btn:disabled{
        pointer-events:none;
        opacity: 0.55;
    }

    /*ゲストユーザーにトレーニングを紐づける*/
    .guest_user_link_btn {
        border: none;
        border-radius: 10px;
        padding: 10px 24px;;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
        background-color: #e7e7e7;
        color: black;
        transition-duration: 0.4s;
    }

    .guest_user_link_btn:hover {
        background-color: #a5a5a5;
        color: white;
    }

    .guest_user_link_btn:before{
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        {% comment %} content: '\f0c1'; {% endcomment %}
        content: '\f007';
        font-size: 17px;
    }





/*---------------------------------

    トレーニングのボタン

---------------------------------*/

    /* 編集 */
    .fas_button_edit{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background: #87c040;
        color: #fff;
        cursor: pointer;
    }
    .fas_button_edit:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f044';
        font-size: 25px;
    }

    /* パーツ並び替え */
    .fas_button_partsoder_change{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background: #ffae01;
        color: #fff;
        cursor: pointer;
    }
    .fas_button_partsoder_change:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f0cb';
        font-size: 25px;
    }


    /* 削除 */
    .fas_button_delete{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background: #565656;
        color: #fff;
        cursor: pointer;
    }
    .fas_button_delete:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f2ed';
        font-size: 25px;
    }

    /* ボタン有効化制御、制御条件 */
    .fas_button_activate_ctl{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background: #207ecf;
        color: #fff;
        cursor: pointer;
    }
    .fas_button_activate_ctl:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f00c';
        font-size: 25px;
    }

    /* ボタン有効化制御、制御条件 */
    .fas_button_activate_ctl_edit{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background: #ff6262;
        color: #fff;
        cursor: pointer;
    }
    .fas_button_activate_ctl_edit:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f00c';
        font-size: 25px;
    }



/*---------------------------------

    パーツのボタン

---------------------------------*/


    /* テストの設問編集 */
    .fa_button_wrench{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background:  #9e87e6;
        color: #fff;
        cursor: pointer;
    }
    .fa_button_wrench:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f1c2';
        font-size: 25px;
    }


    /* コンテンツの追加 */
    .fas_button_content_add{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        {% comment %} background:  #22b8cf; {% endcomment %}
        color: #f2f2f2;
        cursor: pointer;
    }
    .fas_button_content_add:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f15c';
        font-size: 25px;
    }

    /* テスト 設問 */
    .fas_button_exam{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background:  #f783ac;
        color: #fff;
        cursor: pointer;
    }
    .fas_button_exam:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f5ae';
        font-size: 25px;
    }

    /* 編集 */
    .fas_button_edit{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background: #87c040;
        color: #fff;
        cursor: pointer;
    }
    .fas_button_edit:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f044';
        font-size: 25px;
    }

    /* パーツ並び替え */
    .fas_button_partsoder_change{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background: rgb(255 174 1);
        color: #fff;
        cursor: pointer;
    }
    .fas_button_partsoder_change:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f0cb';
        font-size: 25px;
    }


    /* 削除 */
    .fas_button_delete{
        border: none;
        width: 50px;
        height: 50px;
        border-radius: 25px;
        background: #565656;
        color: #fff;
        cursor: pointer;
    }
    .fas_button_delete:before{
        line-height: 50px;
        width: 50px;
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f2ed';
        font-size: 25px;
    }


/*---------------------------------

    パーツ追加のボタン

---------------------------------*/

    .items{
        display: flex;
        justify-content: space-around;
        flex-wrap: wrap;
    }
    /*.items:after{
        content:"";
        display:block;
        width: 32%;
        height:0;
    }*/
    /*.item{
        width: 32%;
        height: 132px;
        border-radius: 3%;
        color: #494949;
        cursor: pointer;
        background: #e1e1e1;
        margin-bottom: 2%;
        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.29);
    }*/


    /* テストパーツ */
    .parts_test{
        position: relative;
        width: 132px;
        height: 132px;
        color: #87C040;
        cursor: pointer;
        background: #f7f7f7;
        margin-bottom: 15px;
        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.29);
    }
    /*  アイコン */
    .parts_test:before{
        position: absolute;
        top: 26%;
        left: 38px;
        line-height: 50px;
        /*width: 50px;*/
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f518';
        font-size: 55px;
    }
    /*  文字 */
    .parts_test:after {
        content: 'テスト';
        font-size: 16px;
        color: #565656;
        position: absolute;
        top: 90px;
        bottom: 0;
        right: 0;
        left: 0;
        margin: auto;
        text-align: center;
        font-weight: 900;
    }


    /* アンケートパーツ */
    .parts_questionnaire{
        position: relative;
        width: 132px;
        height: 132px;
        color: #ffb229;
        cursor: pointer;
        background: #f7f7f7;
        margin-bottom: 2%;
        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.29);
    }
    /*  アイコン */
    .parts_questionnaire:before{
        position: absolute;
        top: 26%;
        left: 38px;
        line-height: 50px;
        /*width: 50px;*/
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f4ad';
        font-size: 55px;
    }
    /*  文字 */
    .parts_questionnaire:after {
        content: 'アンケート';
        font-size: 16px;
        color: #343a40;
        position: absolute;
        top: 90px;
        bottom: 0;
        right: 0;
        left: 0;
        margin: auto;
        text-align: center;
        font-weight: 900;
    }


    /* ファイルアップロードパーツ */
    .parts_file_uplord{
        position: relative;
        width: 132px;
        height: 132px;
        color: #2571AB;
        cursor: pointer;
        background: #f7f7f7;
        margin-bottom: 2%;
        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.29);
    }
    /*  アイコン */
    .parts_file_uplord:before{
        position: absolute;
        top: 26%;
        left: 45px;
        line-height: 50px;
        /*width: 50px;*/
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f574';
        font-size: 55px;
    }
    /*  文字 */
    .parts_file_uplord:after {
        content: 'ファイルUL';
        font-size: 16px;
        color: #565656;
        position: absolute;
        top: 90px;
        bottom: 0;
        right: 0;
        left: 0;
        margin: auto;
        text-align: center;
        font-weight: 900;
    }

    /* 動画パーツ */
    .parts_movie{
        position: relative;
        width: 132px;
        height: 132px;
        color: #ff4133;
        cursor: pointer;
        background: #f7f7f7;
        margin-bottom: 2%;
        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.29);
    }
    /*  アイコン */
    .parts_movie:before{
        position: absolute;
        top: 26%;
        left: 45px;
        line-height: 50px;
        /*width: 50px;*/
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f1c8';
        font-size: 55px;
    }
    /*  文字 */
    .parts_movie:after {
        content: '動画';
        font-size: 16px;
        color: #343a40;
        position: absolute;
        top: 90px;
        bottom: 0;
        right: 0;
        left: 0;
        margin: auto;
        text-align: center;
        font-weight: 900;
    }
    /* 投票パーツ */
    .parts_vote{
        position: relative;
        width: 132px;
        height: 132px;
        color: #4ad395;
        cursor: pointer;
        background: #f7f7f7;
        margin-bottom: 2%;
        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.29);
    }
    /*  アイコン */
    .parts_vote:before{
        position: absolute;
        top: 26%;
        left: 33px;
        line-height: 50px;
        /*width: 50px;*/
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f772';
        font-size: 55px;
    }
    /*  文字 */
    .parts_vote:after {
        content: '投票';
        font-size: 16px;
        color: #343a40;
        position: absolute;
        top: 90px;
        bottom: 0;
        right: 0;
        left: 0;
        margin: auto;
        text-align: center;
        font-weight: 900;
    }

    /* ダウンロードパーツ */
    .parts_file_downlord{
        position: relative;
        width: 132px;
        height: 132px;
        color: #B9D700;
        cursor: pointer;
        background: #f7f7f7;
        margin-bottom: 2%;
        box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.29);
    }
    /*  アイコン */
    .parts_file_downlord:before{
        position: absolute;
        top: 26%;
        left: 45px;
        line-height: 50px;
        /*width: 50px;*/
        text-align: center;
        font-style: normal;
        font-variant: normal;
        text-rendering: auto;
        -webkit-font-smoothing: antialiased;
        font-family: "Font Awesome 5 Free";
        font-weight: 900;
        content: '\f56d';
        font-size: 55px;
    }
    /*  文字 */
    .parts_file_downlord:after {
        content: 'ファイルDL';
        font-size: 16px;
        color: #343a40;
        position: absolute;
        top: 90px;
        bottom: 0;
        right: 0;
        left: 0;
        margin: auto;
        text-align: center;
        font-weight: 900;
    }


    /*---------------------------------

        前のページに戻るボタン

    ---------------------------------*/

    .btn-grp {
        margin: 80px;
    }

    .return_btn {
        color: #ffffff !important;
        background: #7db4e6;
    }

    .my-btn-w12 {
        height: 45px;
        width: 300px;
    }

    /*---------------------------------

        モーダル

    ---------------------------------*/

    #break_banner {
        {% comment %} display: none;
        height: 100vh;
        width: 100%;
        background: rgba(0,0,0,.6);
        opacity: 0.7;
        position: fixed;
        top: 0;
        left: 0; {% endcomment %}

        display: flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100vh;
        padding: 0 24px;
        background: rgba(0,0,0,.6);
        position: fixed;
        top: 0;
        left: 0;
        z-index: 9999;
        {% comment %} opacity: 0;
        pointer-events: none; {% endcomment %}
        transition: all .3s;

    }

    .content{
        background: #fff;
        padding: 30px;
        width: 50%;
        z-index: 9999;

    }

    .show {
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /*---------------------------------

    項目番号
    
    ---------------------------------*/
    .parts-number{
        color:#fff;
        border:4px solid #A0CCDB;
        background:#A0CCDB;
    }

</style>






<div class="container-fluid">


    <!-- messages.succes や messages.errorにて利用 -->
    {% if messages %}
        <div class="messages">
            {% for message in messages %}
            <p {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</p>
            {% endfor %}
        </div>
    {% endif %}

    <!-- セッションのフラグでモーダルを表示するか判断 -->
    {% comment %} <p>セッション表示テスト テスト</p>
    {% if request.session.question_register_done  %}
        {{ request.session.question_register_done }}<br>
    {% endif %}

    <p>セッション表示テスト アンケート</p>
    {% if request.session.questionnaire_register_done  %}
        {{ request.session.questionnaire_register_done }}<br>
    {% endif %} {% endcomment %}


    {% comment %} <p>セッション表示テスト パーツID</p>
    {{ parts_id_str }}<br>
    {{ questionnaire_parts_id_str }} {% endcomment %}


    <div class="mdl_align-height mt-4">

        <div>
            {% comment %} <h4 class="training_title">トレーニング設定</h4> {% endcomment %}
            <sapan class="training_title">トレーニング詳細設定</sapan><span class="label">管理者画面</span><span class="label_co_admin_user ml-2">共同管理者画面</span>
        </div>

    </div>


    <div class="row mt-4">

        {% for training in trainings %}

            {% with movie_count=training.movie.all|length %}
            {% with test_count=training.test.all|length %}
            {% with questionnaire_count=training.questionnaire.all|length %}

            <div class="col-12 mt-2">

                <div class="d-flex mb-4">
                    <!-- リソース状況に空きがない場合 -->
                    {% if remaining_capacity == 0 %}
                        <div class="button-wrapper mr-auto" title="リソースの要領に空きがありません。トレーニング、またはパーツを削除してください。">
                            <button class="fas_button_parts_add btn-tag--favorite mr-auto" id="add_row" disabled>パーツを追加する</button>
                        </div>

                        {% comment %} <div class="button-wrapper ml-auto" title="リソースの要領に空きがありません。トレーニング、またはパーツを削除してください。">
                            <button class="training_copy_btn" disabled> トレーニングを複製する</button>
                        </div> {% endcomment %}
                    {% else %}
                        <button class="fas_button_parts_add btn-tag--favorite mr-auto" id="add_row" data-toggle="modal" data-target="#parts_add_modal" data-pk="{{ training.id }}">パーツを追加する</button>
                        {% comment %} <button class="training_copy_btn" id="" data-toggle="modal" data-target="#training_copy_modal" data-pk="{{ training.id }}"> トレーニングを複製する</button> {% endcomment %}
                    {% endif %}
                    {% comment %} <button class="guest_user_link_btn" data-toggle="modal" data-target="#guest_user_link_modal"> ゲストユーザーに紐づける</button> {% endcomment %}
                </div>

                <div class="card training_card">

                    <div class="d-flex card_header">

                        {% comment %} <div class="d-none d-md-inline-block mt-2 ml-2 mb-2 mr-2"> {% endcomment %}
                        <div class="d-md-inline-block mt-2 ml-2 mb-2 mr-2">
                            <div class="d-flex">
                                <!-- タイトル　ツールチップ -->
                                {% if training.title|length > 15 %}
                                    <div class="menu_title_size" data-toggle="tooltip" title={{training.title}}>{{forloop.counter|zfill:3}}.{{training.title|truncatechars:15}}</div>
                                {% else %}
                                    <div class="menu_title_size">{{forloop.counter|zfill:3}}.{{training.title}}</div>
                                {% endif %}
                            </div>

                            {% if training.description|length > 15 %}
                                <div class="menu_desc_size menu_desc_text" data-toggle="tooltip" title={{training.description}}>{{training.description|safe|truncatechars:15}}</div>
                            {% else %}
                                <div class="menu_desc_size menu_desc_text">{{training.description}}</div>
                            {% endif %}
                            {% comment %} <div class="menu_desc_size menu_desc_text" data-toggle="tooltip" title={{training.description}}>{{training.description|safe|truncatechars:15}}</div> {% endcomment %}
                        </div>


                        {% comment %} <div class="d-none d-md-inline-block mt-2 ml-auto mr-2 mb-2"> {% endcomment %}
                        <div class="d-md-inline-block mt-2 ml-auto mr-2 mb-2">

                            <div class="d-flex">
                                <div class="label_text label_text_w62">発信者</div>
                                {% comment %} <div class="menu_reg_user_size menu_reg_user_text label_border_left pl-3 menu_reg_user_box">{{training.reg_user.company.pic_dept_name}}</div> {% endcomment %}
                                <div class="menu_reg_user_size menu_reg_user_text label_border_left pl-3 menu_reg_user_box">{{training.reg_user|get_training_reguser_company_pic_dept_name}}</div>
                            </div>

                            <div class="d-flex">
                                <div class="label_text label_text_w62" style="visibility: hidden;">発信者</div>
                                {% comment %} <div class="menu_reg_user_size menu_reg_user_text label_border_left pl-3 menu_reg_user_box">{{training.reg_user.display_name}}</div> {% endcomment %}
                                <div class="menu_reg_user_size menu_reg_user_text label_border_left pl-3 menu_reg_user_box">{{training.reg_user|get_training_reguser_display_name}}</div>
                            </div>

                        </div>

                        {% comment %} <div class="d-none d-md-inline-block mt-2 ml-3 mr-4 mb-2"> {% endcomment %}
                        <div class="d-md-inline-block mt-2 ml-3 mr-4 mb-2">

                            <div class="d-inline-flex">
                                <div class="label_text label_text_w90 label_border_right pr-3 mr-3">ステータス</div>
                                {% comment %} {% with training_manage=training.training_manage.all|get_model_obj:current_user %}
                                    {% if training_manage.status == 1 %} <!-- 未対応 -->
                                        <div class="label_status menu_sutatus_size glay label_status_custom">{{training_manage.get_status_display}}</div>
                                    {% elif training_manage.status == 2 %} <!-- 対応中 -->
                                        <div class="label_status menu_sutatus_size blue label_status_custom">{{training_manage.get_status_display}}</div>
                                    {% elif training_manage.status == 3 %} <!-- 完了 -->
                                        <div class="label_status menu_sutatus_size done label_status_custom">{{training_manage.get_status_display}}</div>
                                    {% endif %}
                                {% endwith %}

                                <div class="ml-1 period_rem_date menu_sutatus_size" data-period_date="{{ training.end_date|date:'Y/m/d H:i' }}">ステータス</div> {% endcomment %}
                            </div>

                            <div class="menu_sutatus_size">

                                <div class="d-flex">
                                    <div class="label_text label_text_w90 label_border_right pr-3 mr-3">対応期限</div>
                                    <div class="menu_status_box" data-toggle="tooltip" title="{{ training.end_date|date:'Y/m/d H:i' }}">{{ training.end_date|date:'Y/m/d H:i'}}</div>
                                </div>

                                <div class="d-flex">
                                    <div class="label_text label_text_w90 label_border_right pr-3 mr-3"></div>
                                    {% comment %} <div data-toggle="tooltip" title="{{ training.period_date|date:'Y/m/d H:i' }}">{{ training.period_date|date:'H:i'}}まで</div> {% endcomment %}
                                    {% comment %} <div class="period_rem_date" data-period_date="{{ training.period_date|date:'Y/m/d H:i' }}">ステータス</div> {% endcomment %}
                                </div>

                                <div class="d-flex">
                                    <div class="label_text label_text_w90 label_border_right pr-3 mr-3">対応完了</div>
                                    {% if training.status.id == 3 %} <!-- 完了 -->
                                        <div class="menu_status_box" data-toggle="tooltip" title="{{ training.done_date|date:'Y/m/d H:i' }}">{{ training.done_date|date:'Y/m/d H:i'}}</div>
                                    {% endif %}
                                </div>

                            </div>


                        </div>


                        <!-- 編集ボタン 〇アイコン -->
                        {% comment %} <div class="d-flex align-items-center p-3"> {% endcomment %}
                        <div class="d-flex p-3">

                            <!-- パーツが存在する場合 -->
                            {% if training.parts.all %}

                                <!-- パーツの数が2個以上の場合 -->
                                {% if training.parts.all|length >= 2 %}
                                    <!-- 順番変更ボタンを有効化 -->
                                    <button type="button" title="パーツの並び替え" id="" class="fas_button_partsoder_change mr-2" onclick="window.location.href='{% url 'training:parts_sorting' training.pk %}'"></button>

                                    <!-- ボタン有効化制御、制御条件登録ボタン -->
                                    <button type="button" title="ボタン有効化制御、制御条件登録" class="fas_button_activate_ctl mr-2" onclick="window.location.href='{% url 'training:button_activate_ctl' training.pk %}'"></button>
                                {% else %}
                                    <!-- 順番変更ボタンを有効化 無効化 -->
                                    <button type="button" title="パーツの並び替え" id="" class="fas_button_partsoder_change mr-2" onclick="window.location.href=''" style="pointer-events: none; opacity: 0.5;"></button>

                                    <!-- ボタン有効化制御、制御条件登録ボタン 無効化 -->
                                    <button type="button" title="ボタン有効化制御、制御条件登録" class="fas_button_activate_ctl mr-2" onclick="window.location.href=''" style="pointer-events: none; opacity: 0.5;"></button>
                                {% endif %}

                            {% else %}
                                <!-- 順番変更ボタンを無効化 -->
                                <button type="button" title="パーツの並び替え" id="" class="fas_button_partsoder_change mr-2" onclick="window.location.href=''" style="pointer-events: none; opacity: 0.5;"></button>

                                <!-- ボタン有効化制御、制御条件登録ボタン 無効化 -->
                                <button type="button" title="ボタン有効化制御、制御条件登録" class="fas_button_activate_ctl mr-2" onclick="window.location.href=''" style="pointer-events: none; opacity: 0.5;"></button>

                            {% endif %}

                            <!-- 編集ボタン -->
                            <button type="button" title="変更" class="fas_button_edit mr-2" onclick="window.location.href='{% url 'training:training_update' training.pk %}'"></button>

                            <!-- 削除ボタン -->
                            {% if current_user|get_co_admin_user %}
                                <!-- 共同管理者の場合 -->
                                {% if parts.parts_user.display_name == login_user.display_name %}
                                    <!-- パーツの作成者が共同管理者の場合 -->
                                    <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#training_delete_modal" data-pk="{{ training.id }}" class="fas_button_delete mr-2"></button>
                                {% else %}
                                    <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#training_delete_modal" data-pk="{{ training.id }}" class="fas_button_delete mr-2" style="pointer-events: none; opacity: 0.5;"></button>
                                {%  endif %}
                            {% else %}
                                <!-- 管理者の場合 -->
                                <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#training_delete_modal" data-pk="{{ training.id }}" class="fas_button_delete mr-2"></button>
                            {%  endif %}
                        </div>

                    </div>
                </div>


                {% comment %} 詳細行 {% endcomment %}

                <div class="childe1 mt-1">

                    {% for parts in training.parts.all %}

                        {% if parts.type == 1 %}<!-- ファイル -->

                        <div class="parts_card">
                            <div class="d-flex ml-4 card_body">

                                {% comment %} <div class="d-none d-md-inline-block position-relative"> {% endcomment %}
                                <div class="d-md-inline-block position-relative">
                                    <div class="maru size_m_l parts-number position-absolute maru_posi">
                                        <div class="letter_two_personal_l font-weight-bold">{{forloop.counter}}</div>
                                    </div>
                                </div>

                                <!-- アイコン -->
                                {% comment %} <div class="d-none d-md-inline-block mt-3 ml-5 mb-3"> {% endcomment %}
                                <div class="d-md-inline-block mt-3 ml-5 mb-3">
                                    <div class="">
                                        <i class="fas fa-file-download menu_icon"></i>
                                    </div>
                                </div>

                                {% comment %} <div class="d-none d-md-inline-block mt-3 ml-4 mb-3 mr-2 title_desc_box"> {% endcomment %}
                                <div class="d-md-inline-block mt-3 ml-4 mb-3 mr-2 title_desc_box">
                                    <div class="d-flex flex-column">
                                        <div class="menu_title_size">ファイルダウンロード</div>
                                        {% comment %} <div class="text-danger mb-2">※配布資料につきましては課内供覧を行うようお願いします。</div> {% endcomment %}

                                        <!-- 説明　ツールチップ -->
                                        {% if parts.description|length > 15 %}
                                        <div class="menu_desc_size menu_desc_text" data-toggle="tooltip" title={{parts.description}}>{{parts.description|truncatechars:15}}</div>
                                        {% else %}
                                            <div class="menu_desc_size menu_desc_text">{{parts.description}}</div>
                                        {% endif %}
                                    </div>

                                    <div class="file_download">
                                        {% for file in parts.file.all %}
                                            {% if parts.parts_manage %}

                                                {% with parts_manage=parts.parts_manage.all|get_model_obj:current_user %}

                                                    {% with is_file_exits=parts_manage.file_manage.all|is_exists:file.file_id %}
                                                        <!-- リンクを無効にする-->
                                                        <a id="{{ file.file_id }}" data-parts_id="{{ parts.id }}" download="{{ file.name }}" target="_blank" title="{{ file.name }}">
                                                            <div class="">
                                                                <div class="d-inline"><i class="far fa-file-alt menu_file_icon_size menu_file_name_color"></i></div>
                                                                <div class="d-inline ml-1 align-self-center menu_file_name_size menu_file_name_color">{{ file.name }} <span class="download_status">{% if is_file_exits %} <i class="fas fa-check" style="color:green"></i> {%endif%}</span> </div>
                                                            </div>
                                                        </a>
                                                    {% endwith %}

                                                {% endwith %}

                                            {% else %}
                                                {% with is_file_exits="False" %}
                                                    <!-- リンクを無効にする-->
                                                    <a id="{{ file.file_id }}" data-parts_id="{{ parts.id }}" download="{{ file.name }}" target="_blank" data-toggle="tooltip" title="{{ file.name }}">
                                                        <div class="">
                                                            <div class="d-inline"><i class="far fa-file-alt menu_file_icon_size menu_file_name_color"></i></div>
                                                            <div class="d-inline ml-1 align-self-center menu_file_name_size menu_file_name_color">{{ file.name }} <span class="download_status">{% if is_file_exits != "False" %} <i class="fas fa-check" style="color:green"></i> {%endif%}</span> </div>
                                                        </div>
                                                    </a>
                                                {% endwith %}
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                </div>



                                {% comment %} <div class="d-none d-md-inline-block mt-3 ml-auto mr-3 mb-3 reg_user_box"> {% endcomment %}
                                <div class="d-md-inline-block mt-3 ml-auto mr-3 mb-3 reg_user_box">
                                    <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.company.pic_dept_name}}</div>
                                    <div class="menu_reg_user_size menu_reg_user_text">{{parts.parts_user.display_name}}</div>
                                    {% comment %} <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.display_name}}</div> {% endcomment %}
                                </div>


                                {% comment %} <div class="d-none d-md-inline-block mt-3 ml-2 mr-2 mb-3"> {% endcomment %}
                                {% comment %} <div class="d-none d-md-inline-block mt-3 ml-1 mr-5 mb-3"> {% endcomment %}
                                <div class="d-md-inline-block mt-3 ml-1 mr-5 mb-3">
                                {% comment %} <div class="d-none d-md-inline-block mt-3 ml-2 mr-5 mb-3"> {% endcomment %}
                                    {% comment %} {% with parts_manage=parts.parts_manage.all|get_model_obj:current_user %}

                                        {% if parts_manage.status == 1 %} <!-- 未対応 -->
                                            <div class="label_status menu_sutatus_size glay">{{parts_manage.get_status_display}}</div>
                                        {% elif parts_manage.status == 2 %} <!-- 対応中 -->
                                            <div class="label_status menu_sutatus_size blue">{{parts_manage.get_status_display}}</div>
                                        {% elif parts_manage.status == 3 %} <!-- 完了 -->
                                            <div class="label_status menu_sutatus_size done">{{parts_manage.get_status_display}}</div>
                                        {% else %}<!-- 未対応 -->
                                            <div class="label_status menu_sutatus_size glay">未対応</div>
                                        {% endif %}

                                    {% endwith %} {% endcomment %}


                                    <div class="text-center menu_sutatus_size">
                                        <div data-toggle="tooltip" title="{{ training.end_date|date:'Y/m/d H:i' }}">{{ training.end_date|date:'Y/m/d'}}</div>
                                        <div data-toggle="tooltip" title="{{ training.end_date|date:'Y/m/d H:i' }}">{{ training.end_date|date:'H:i'}}まで</div>
                                        <div class="period_rem_date" data-period_date="{{ training.end_date|date:'Y/m/d H:i' }}">ステータス</div>
                                    </div>
                                </div>



                                    <!-- 編集ボタン 〇アイコン -->
                                    {% comment %} <div class="d-flex align-items-center ml-5 p-3"> {% endcomment %}
                                    <div class="d-flex ml-5 p-3">
                                        <button type="button" title="変更" id="" class="fas_button_edit ml-4 mr-2" onclick="window.location.href='{% url 'training:parts_file_update' parts.pk %}'"></button>

                                        {% if current_user|get_co_admin_user %}
                                            <!-- 共同管理者の場合 -->
                                            {% if parts.parts_user.display_name == login_user.display_name %}
                                                <!-- パーツの作成者が共同管理者の場合 -->
                                                <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2"></button>
                                            {% else %}
                                                <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2" style="pointer-events: none; opacity: 0.5;"></button>
                                            {%  endif %}
                                        {% else %}
                                            <!-- 管理者の場合 -->
                                            <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2"></button>
                                        {%  endif %}
                                    </div>




                            </div>



                        </div><!-- ここまで -->


                        {% endif %}


                        {% if parts.type == 2 %}{% comment %} 動画 {% endcomment %}

                                <div class="parts_card">
                                    <div class="d-flex ml-4 card_body">


                                        {% comment %} <div class="d-none d-md-inline-block position-relative"> {% endcomment %}
                                        <div class="d-md-inline-block position-relative">
                                            <div class="maru size_m_l parts-number position-absolute maru_posi">
                                                <div class="letter_two_personal_l font-weight-bold">{{forloop.counter}}</div>
                                            </div>
                                        </div>

                                        <!-- アイコン -->
                                        {% comment %} <div class="d-none d-md-inline-block mt-3 ml-5 mb-3"> {% endcomment %}
                                        <div class="d-md-inline-block mt-3 ml-5 mb-3">
                                            <div class="">
                                                {% comment %} <img class="w-100" src=static/training/img/movie.png> {% endcomment %}
                                                <i class="fas fa-file-video menu_icon"></i>
                                            </div>
                                        </div>

                                        {% comment %} <div class="d-none d-md-inline-block mt-3 ml-4 mb-3 mr-2 title_desc_box"> {% endcomment %}
                                        <div class="d-md-inline-block mt-3 ml-4 mb-3 mr-2 title_desc_box">
                                            <!-- タイトル　ツールチップ -->
                                            {% if parts.title|length > 15 %}
                                                <div class="menu_title_size" data-toggle="tooltip" title={{parts.title}}><span class="movie_title">{{parts.title|truncatechars:15}}</span></div>
                                            {% else %}
                                                <div class="menu_title_size"><span class="movie_title">{{parts.title}}</span></div>
                                            {% endif %}

                                            <!-- 説明　ツールチップ -->
                                            {% if parts.description|length > 15 %}
                                            <div class="menu_desc_size menu_desc_text" data-toggle="tooltip" title={{parts.description}}>{{parts.description|truncatechars:15}}</div>
                                            {% else %}
                                                <div class="menu_desc_size menu_desc_text">{{parts.description}}</div>
                                            {% endif %}

                                            {% comment %} <div class="menu_title_size"><span class="movie_title">{{parts.title}}</span> <span class=" menu_desc_size float-right mt-1 mr-1"><i class="far fa-clock mr-1"></i>{{parts.duration}}</span></div> {% endcomment %}

                                            {% comment %} <div class="menu_title_size"><span class="movie_title">{{parts.title}}</span></div>
                                            <div class="menu_desc_size menu_desc_text">{{parts.description}}</div> {% endcomment %}
                                        </div>


                                        {% comment %} <div class="d-none d-md-inline-block mt-3 ml-auto mr-3 mb-3 reg_user_box"> {% endcomment %}
                                        <div class="d-md-inline-block mt-3 ml-auto mr-3 mb-3 reg_user_box">
                                            {% comment %} <div class="menu_reg_user_size menu_reg_user_width_size menu_reg_user_text menu_reg_user_text_position">発信者</div> {% endcomment %}
                                            {% comment %} <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.company.pic_company_name}}</div> {% endcomment %}
                                            <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.company.pic_dept_name}}</div>
                                            <div class="menu_reg_user_size menu_reg_user_text">{{parts.parts_user.display_name}}</div>
                                            {% comment %} <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.display_name}}</div> {% endcomment %}
                                        </div>

                                        {% comment %} <div class="d-none d-md-inline-block mt-3 ml-1 mr-5 mb-3"> {% endcomment %}
                                        <div class="d-md-inline-block mt-3 ml-1 mr-5 mb-3">
                                            {% comment %} {% with parts_manage=parts.parts_manage.all|get_model_obj:current_user %}

                                                {% if parts_manage.status == 1 %} <!-- 未対応 -->
                                                    <div class="label_status menu_sutatus_size glay">{{parts_manage.get_status_display}}</div>
                                                {% elif parts_manage.status == 2 %} <!-- 対応中 -->
                                                    <div class="label_status menu_sutatus_size blue">{{parts_manage.get_status_display}}</div>
                                                {% elif parts_manage.status == 3 %} <!-- 完了 -->
                                                    <div class="label_status menu_sutatus_size done">{{parts_manage.get_status_display}}</div>
                                                {% else %}
                                                    <div class="label_status menu_sutatus_size glay">未対応</div>
                                                {% endif %}

                                            {% endwith %} {% endcomment %}


                                            <div class="text-center menu_sutatus_size">
                                                <div data-toggle="tooltip" title="{{ training.end_date|date:'Y/m/d H:i' }}">{{ training.end_date|date:'Y/m/d'}}</div>
                                                <div data-toggle="tooltip" title="{{ training.end_date|date:'Y/m/d H:i' }}">{{ training.end_date|date:'H:i'}}まで</div>
                                                <div class="period_rem_date" data-period_date="{{ training.end_date|date:'Y/m/d H:i' }}">ステータス</div>
                                            </div>
                                        </div>




                                        <!-- 編集ボタン 〇アイコン -->
                                        {% comment %} <div class="d-flex align-items-center ml-5 p-3"> {% endcomment %}
                                        <div class="d-flex ml-5 p-3">
                                            <button type="button" title="変更" id="" class="fas_button_edit ml-4 mr-2" onclick="window.location.href='{% url 'training:parts_movie_update' parts.pk %}'"></button>

                                            {% if current_user|get_co_admin_user %}
                                            <!-- 共同管理者の場合 -->
                                                {% if parts.parts_user.display_name == login_user.display_name %}
                                                    <!-- パーツの作成者が共同管理者の場合 -->
                                                    <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2"></button>
                                                {% else %}
                                                    <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2" style="pointer-events: none; opacity: 0.5;"></button>
                                                {%  endif %}
                                            {% else %}
                                                <!-- 管理者の場合 -->
                                                <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2"></button>
                                            {%  endif %}
                                        </div>

                                    </div>

                                </div>


                        {% endif %}


                        {% if parts.type == 3 %}{% comment %} テスト {% endcomment %}


                                    <div class="parts_card">
                                        <div class="d-flex ml-4 card_body">

                                            {% comment %} <div class="d-none d-md-inline-block position-relative"> {% endcomment %}
                                            <div class="d-md-inline-block position-relative">
                                                <div class="maru size_m_l parts-number position-absolute maru_posi">
                                                    <div class="letter_two_personal_l font-weight-bold">{{forloop.counter}}</div>
                                                </div>
                                            </div>

                                            <!-- アイコン -->
                                            {% comment %} <div class="d-none d-md-inline-block mt-2 ml-5 mb-2"> {% endcomment %}
                                            <div class="d-md-inline-block mt-2 ml-5 mb-2">
                                                <div class="">
                                                    {% comment %} <img class="w-100" src=static/training/img/test.png> {% endcomment %}
                                                    <i class="fas fa-file-contract menu_icon"></i>
                                                </div>
                                            </div>

                                            {% comment %} <div class="d-none d-md-inline-block mt-3 ml-4 mb-3 mr-2 title_desc_box"> {% endcomment %}
                                            <div class="d-md-inline-block mt-3 ml-4 mb-3 mr-2 title_desc_box">
                                                <!-- タイトル　ツールチップ -->
                                                {% if parts.title|length > 15 %}
                                                    <div class="menu_title_size" data-toggle="tooltip" title={{parts.title}}>{{parts.title|truncatechars:15}}</div>
                                                {% else %}
                                                    <div class="menu_title_size">{{parts.title}}</div>
                                                {% endif %}

                                                <!-- 説明　ツールチップ -->
                                                {% if parts.description|length > 15 %}
                                                    <div class="menu_desc_size menu_desc_text" data-toggle="tooltip" title={{parts.description}}>{{parts.description|truncatechars:15}}</div>
                                                {% else %}
                                                    <div class="menu_desc_size menu_desc_text">{{parts.description}}</div>
                                                {% endif %}

                                                {% comment %} <div class="menu_title_size">{{parts.title}}</div>
                                                <div class="menu_desc_size menu_desc_text">{{parts.description}}</div> {% endcomment %}
                                            </div>


                                            {% comment %} <div class="d-none d-md-inline-block mt-3 ml-auto mr-2 mb-3 reg_user_box"> {% endcomment %}
                                            <div class="d-md-inline-block mt-3 ml-auto mr-2 mb-3 reg_user_box">
                                                {% comment %} <div class="menu_reg_user_size menu_reg_user_width_size menu_reg_user_text menu_reg_user_text_position">発信者</div> {% endcomment %}
                                                {% comment %} <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.company.pic_company_name}}</div> {% endcomment %}
                                                <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.company.pic_dept_name}}</div>
                                                <div class="menu_reg_user_size menu_reg_user_text">{{parts.parts_user.display_name}}</div>
                                                {% comment %} <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.display_name}}</div> {% endcomment %}
                                            </div>


                                            {% comment %} <div class="d-none d-md-inline-block mt-3 ml-2 mr-2 mb-3"> {% endcomment %}
                                            <div class="d-md-inline-block mt-3 ml-2 mr-2 mb-3">
                                                {% comment %} {% if parts.testmanage_set.all %}

                                                    {% for testmanage in parts.testmanage_set.all　%}
                                                        {% if testmanage.status.id == 1 %} <!-- 未対応 -->
                                                            <div class="label_status menu_sutatus_size glay">{{testmanage.status}}</div>
                                                        {% elif testmanage.status.id == 2 %} <!-- 対応中 -->
                                                            <div class="label_status menu_sutatus_size blue">{{testmanage.status}}</div>
                                                        {% elif testmanage.status.id == 3 %} <!-- 完了 -->
                                                            <div class="label_status menu_sutatus_size done">{{testmanage.status}}</div>
                                                        {% endif %}
                                                    {% endfor %}

                                                {% else %}
                                                        <div class="label_status menu_sutatus_size glay">未対応</div>
                                                {% endif %} {% endcomment %}



                                                {% comment %} {% with parts_manage=parts.parts_manage.all|get_model_obj:current_user %}

                                                    {% if parts_manage.status == 1 %} <!-- 未対応 -->
                                                        <div class="label_status menu_sutatus_size glay">{{parts_manage.get_status_display}}</div>
                                                    {% elif parts_manage.status == 2 %} <!-- 対応中 -->
                                                        <div class="label_status menu_sutatus_size blue">{{parts_manage.get_status_display}}</div>
                                                    {% elif parts_manage.status == 3 %} <!-- 完了 -->
                                                        <div class="label_status menu_sutatus_size done">{{parts_manage.get_status_display}}</div>
                                                    {% else %}
                                                        <div class="label_status menu_sutatus_size glay">未対応</div>
                                                    {% endif %}

                                                {% endwith %} {% endcomment %}

                                                <div class="text-center menu_sutatus_size">
                                                    <div data-toggle="tooltip" title="{{ training.end_date|date:'Y/m/d H:i' }}">{{ training.end_date|date:'Y/m/d'}}</div>
                                                    <div data-toggle="tooltip" title="{{ training.end_date|date:'Y/m/d H:i' }}">{{ training.end_date|date:'H:i'}}まで</div>
                                                    <div class="period_rem_date" data-period_date="{{ training.end_date|date:'Y/m/d H:i' }}">ステータス</div>
                                                </div>
                                            </div>


                                            {% comment %} <div class="d-flex align-items-center">
                                                <button type="submit" id="" class="my-btn my-btn-egypt-1 my-btn-w5 mr-2 training_create_btn"><span class="my_btn_text">コンテンツ<br>追加</span></button>
                                                <button type="submit" id="" class="my-btn my-btn-egypt-1 my-btn-w5 mr-2 training_create_btn"><span class="my_btn_text">トレーニング<br>変更</span></button>
                                                <button type="submit" id="" class="my-btn my-btn-egypt-1 my-btn-w5 mr-2 training_create_btn"><span class="my_btn_text">編集</span></button>
                                                <button type="submit" id="" class="my-btn my-btn-egypt-1 my-btn-w5 mr-2 training_create_btn"><span class="my_btn_text">削除</span></button>
                                            </div> {% endcomment %}



                                            <!-- 編集ボタン 〇アイコン -->
                                            {% comment %} <div class="d-flex align-items-center p-3"> {% endcomment %}
                                            <div class="d-flex p-3">
                                                <button type="button" title="設問作成" id="" class="fas_button_exam mr-2" onclick="window.location.href='{% url 'training:question_register' parts.pk %}'"></button>
                                                <button type="button" title="設問編集" id="" class="fa_button_wrench mr-2" onclick="window.location.href='{% url 'training:question_management' parts.pk %}'"></button>
                                                <button type="button" title="変更" id="" class="fas_button_edit mr-2" onclick="window.location.href='{% url 'training:parts_test_update' parts.pk %}'"></button>

                                                {% if current_user|get_co_admin_user %}
                                                    <!-- 共同管理者の場合 -->
                                                    {% if parts.parts_user.display_name == login_user.display_name %}
                                                        <!-- パーツの作成者が共同管理者の場合 -->
                                                        <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2"></button>
                                                    {% else %}
                                                        <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2" style="pointer-events: none; opacity: 0.5;"></button>
                                                    {% endif %}
                                                {% else %}
                                                    <!-- 管理者の場合 -->
                                                    <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2"></button>
                                                {% endif %}
                                            </div>

                                        </div>
                                    </div>


                        {% endif %}


                        {% if parts.type == 4 %}{% comment %} アンケート {% endcomment %}

                            <div class="parts_card">
                                <div class="d-flex ml-4 card_body">

                                    {% comment %} <div class="d-none d-md-inline-block position-relative"> {% endcomment %}
                                    <div class="d-md-inline-block position-relative">
                                        <div class="maru size_m_l parts-number position-absolute maru_posi">
                                            <div class="letter_two_personal_l font-weight-bold">{{forloop.counter}}</div>
                                        </div>
                                    </div>


                                    <!-- アイコン -->
                                    {% comment %} <div class="d-none d-md-inline-block mt-3 ml-5 mb-3"> {% endcomment %}
                                    <div class="d-md-inline-block mt-3 ml-5 mb-3">
                                        <div class="" >
                                            {% comment %} <img class="w-100" src=static/training/img/question.png> {% endcomment %}
                                            <i class="fas fa-file-alt menu_icon"></i>
                                        </div>
                                    </div>

                                    {% comment %} <div class="d-none d-md-inline-block mt-3 ml-4 mb-3 mr-2 title_desc_box"> {% endcomment %}
                                    <div class="d-md-inline-block mt-3 ml-4 mb-3 mr-2 title_desc_box">
                                        <!-- タイトル　ツールチップ -->
                                        {% if parts.title|length > 15 %}
                                            <div class="menu_title_size" data-toggle="tooltip" title={{parts.title}}>{{parts.title|truncatechars:15}}</div>
                                            {% else %}
                                            <div class="menu_title_size">{{parts.title}}</div>
                                        {% endif %}

                                        <!-- 説明　ツールチップ -->
                                        {% if parts.description|length > 15 %}
                                            <div class="menu_desc_size menu_desc_text" data-toggle="tooltip" title={{parts.description}}>{{parts.description|truncatechars:15}}</div>
                                        {% else %}
                                            <div class="menu_desc_size menu_desc_text">{{parts.description}}</div>
                                        {% endif %}

                                        {% comment %} <div class="menu_title_size">{{parts.title}}</div>
                                        <div class="menu_desc_size menu_desc_text">{{parts.description}}</div> {% endcomment %}
                                    </div>


                                    {% comment %} <div class="d-none d-md-inline-block mt-3 ml-auto mr-2 mb-3 reg_user_box"> {% endcomment %}
                                    <div class="d-md-inline-block mt-3 ml-auto mr-2 mb-3 reg_user_box">
                                        <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.company.pic_dept_name}}</div>
                                        <div class="menu_reg_user_size menu_reg_user_text">{{parts.parts_user.display_name}}</div>
                                        {% comment %} <div class="menu_reg_user_size menu_reg_user_text">{{training.reg_user.display_name}}</div> {% endcomment %}
                                    </div>


                                    {% comment %} <div class="d-none d-md-inline-block mt-3 ml-2 mr-2 mb-3"> {% endcomment %}
                                    <div class="d-md-inline-block mt-3 ml-2 mr-2 mb-3">
                                        {% comment %} {% with parts_manage=parts.parts_manage.all|get_model_obj:current_user %}

                                            {% if parts_manage.status == 1 %} <!-- 未対応 -->
                                                <div class="label_status menu_sutatus_size glay">{{parts_manage.get_status_display}}</div>
                                            {% elif parts_manage.status == 2 %} <!-- 対応中 -->
                                                <div class="label_status menu_sutatus_size blue">{{parts_manage.get_status_display}}</div>
                                            {% elif parts_manage.status == 3 %} <!-- 完了 -->
                                                <div class="label_status menu_sutatus_size done">{{parts_manage.get_status_display}}</div>
                                            {% else %}
                                                <div class="label_status menu_sutatus_size glay">未対応</div>
                                            {% endif %}

                                        {% endwith %} {% endcomment %}

                                        <div class="text-center menu_sutatus_size">
                                            <div data-toggle="tooltip" title="{{ training.end_date|date:'Y/m/d H:i' }}">{{ training.end_date|date:'Y/m/d'}}</div>
                                            <div data-toggle="tooltip" title="{{ training.end_date|date:'Y/m/d H:i' }}">{{ training.end_date|date:'H:i'}}まで</div>
                                            <div class="period_rem_date" data-period_date="{{ training.end_date|date:'Y/m/d H:i' }}">ステータス</div>
                                        </div>
                                    </div>



                                    {% comment %} <div class="d-flex align-items-center">
                                        <button type="submit" id="" class="my-btn my-btn-egypt-1 my-btn-w5 mr-2 training_create_btn"><span class="my_btn_text">コンテンツ<br>追加</span></button>
                                        <button type="submit" id="" class="my-btn my-btn-egypt-1 my-btn-w5 mr-2 training_create_btn"><span class="my_btn_text">コンテンツ<br>変更</span></button>
                                        <button type="submit" id="" class="my-btn my-btn-egypt-1 my-btn-w5 mr-2 training_create_btn"><span class="my_btn_text">編集</span></button>
                                        <button type="submit" id="" class="my-btn my-btn-egypt-1 my-btn-w5 mr-2 training_create_btn"><span class="my_btn_text">削除</span></button>
                                    </div> {% endcomment %}


                                    <!-- 編集ボタン 〇アイコン -->
                                    {% comment %} <div class="d-flex align-items-center p-3"> {% endcomment %}
                                    <div class="d-flex p-3">
                                        <button type="button" title="設問作成" id="" class="fas_button_exam mr-2" onclick="window.location.href='{% url 'training:questionnaire_register' parts.pk %}'"></button>
                                        <button type="button" title="設問編集" id="" class="fa_button_wrench mr-2" onclick="window.location.href='{% url 'training:questionnaire_management' parts.pk %}'"></button>
                                        <button type="button" title="変更" id="" class="fas_button_edit mr-2" onclick="window.location.href='{% url 'training:parts_questionnaire_update' parts.pk %}'"></button>

                                        {% if current_user|get_co_admin_user %}
                                            <!-- 共同管理者の場合 -->
                                            {% if parts.parts_user.display_name == login_user.display_name %}
                                                <!-- パーツの作成者が共同管理者の場合 -->
                                                <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2"></button>
                                            {% else %}
                                                <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2" style="pointer-events: none; opacity: 0.5;"></button>
                                            {%  endif %}
                                        {% else %}
                                            <!-- 管理者の場合 -->
                                            <button type="button" title="削除" id="delete_row" data-toggle="modal" data-target="#parts_delete_modal{{forloop.counter}}" data-pk="{{ parts.id }}" class="fas_button_delete mr-2"></button>
                                        {% endif %}
                                    </div>

                                </div>

                            </div>


                        {% endif %}


                        <!-- 削除モーダルの設定 パーツ -->
                        <div class="modal fade" id="parts_delete_modal{{forloop.counter}}" tabindex="-1" role="dialog" aria-labelledby="mypartsModalLabel">

                            <div class="modal-dialog modal-dialog-centered">

                                <div class="modal-content">

                                    <div class="modal-header">

                                        <h5 class="modal-title" id="mypartsModalLabel" style="font-weight: bold; text">パーツの削除確認</h5>

                                        <button type="button" class="close" data-dismiss="modal" aria-label="閉じる">
                                            <span aria-hidden="true">&times;</span>
                                        </button>

                                    </div>

                                    <div class="modal-body">

                                        <h6><i class="fas fa-exclamation-circle" style="color: #dc3e45;"></i>「{{ parts.title }}」を削除しますか？</h6>
                                        <h6>※ボタン有効化制御・制御条件を設定している場合、パーツ削除により設定したボタンの制御の情報も削除されます。</h6>

                                    </div>

                                    <div class="modal-footer justify-content-center">

                                        <form action="{% url 'training:parts_delete' parts.id %}" method="POST" id="delete-form">
                                        {% comment %} <form action="" method="POST" id="delete-form"> {% endcomment %}
                                            {% csrf_token %}

                                            <div class="btn_group">
                                                <button type="button" class="my-btn my-btn-gray-2 my-btn-w7 mr-3" data-dismiss="modal">閉じる</button>
                                                <button type="submit" id="parts_delete_btn" class="my-btn my-btn-egypt-1 my-btn-w7">削除</button>
                                            </div>

                                        </form>

                                    </div><!-- /.modal-footer -->

                                </div><!-- /.modal-content -->

                            </div><!-- /.modal-card -->

                        </div><!-- /.modal -->



                        <!-- テストの設問作成確認モーダル -->
                        <div class="modal" data-keyboard="false" data-backdrop="static" id="question_register_modal" tabindex="-1">

                            <div class="modal-dialog modal-dialog-centered">

                                <div class="modal-content">

                                    <div class="modal-header">

                                        <h5 class="modal-title" id="mypartsModalLabel" style="font-weight: bold; text">テストの設問作成</h5>

                                        <button type="button" class="close" data-dismiss="modal" aria-label="閉じる" onclick="window.location.href='{% url 'training:cancel_question_register' training.pk %}'">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div><!-- /.modal-header -->

                                    <div class="modal-body">
                                        <h5 class="text-center m-0 p-3">続けて設問を作成しますか？</h5>
                                    </div><!-- /.modal-body -->

                                    <div class="modal-footer justify-content-center">

                                        <!-- ボタン -->
                                        {% comment %} <div class="d-flex justify-content-center btns"> {% endcomment %}
                                        <div class="btn_group">

                                            <!-- トレーニング詳細設定へ遷移　バックエンドでセッションを削除 -->
                                            <button type="button" id="choice_no" class="my-btn my-btn-gray-2 my-btn-w7 mr-3" data-dismiss="modal" onclick="window.location.href='{% url 'training:cancel_question_register' training.pk %}'"><span class="my_btn_text">いいえ</span></button>

                                            <!-- 設問作成画面へ遷移 -->
                                            {% if parts_id_str %}
                                                <button type="button" id="question_create_btn" class="my-btn my-btn-egypt-1 my-btn-w7" onclick="window.location.href='{% url 'training:question_register' parts_id_str %}'"><span class="my_btn_text">はい</span></button>
                                            {% endif %}

                                        </div>
                                    {% comment %} </div><!-- /.modal-body --> {% endcomment %}
                                    </div><!-- /.modal-footer -->

                                </div><!-- /.modal-content -->

                            </div><!-- /.modal-dialog -->

                        </div><!-- /.modal -->


                        <!-- アンケートの設問作成確認モーダル -->
                        <div class="modal" data-keyboard="false" data-backdrop="static" id="questionnaire_register_modal" tabindex="-1">

                            <div class="modal-dialog modal-dialog-centered">

                                <div class="modal-content">

                                    <div class="modal-header">
                                        <h5 class="modal-title" id="mypartsModalLabel" style="font-weight: bold; text">アンケートの設問作成</h5>

                                        <button type="button" class="close" data-dismiss="modal" aria-label="閉じる" onclick="window.location.href='{% url 'training:cancel_questionnaire_register' training.pk %}'">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div><!-- /.modal-header -->

                                    <div class="modal-body">
                                        <h5 class="text-center m-0 p-3">続けて設問を作成しますか？</h5>
                                    </div><!-- /.modal-body -->

                                    <div class="modal-footer justify-content-center">

                                        <!-- ボタン -->
                                        {% comment %} <div class="d-flex justify-content-center btns"> {% endcomment %}
                                        <div class="btn_group">

                                            <!-- トレーニング詳細設定へ遷移　バックエンドでセッションを削除 -->
                                            <button type="button" id="" class="my-btn my-btn-gray-2 my-btn-w7 mr-3" data-dismiss="modal" onclick="window.location.href='{% url 'training:cancel_questionnaire_register' training.pk %}'"><span class="my_btn_text">いいえ</span></button>

                                            <!-- 設問作成画面へ遷移 -->
                                            {% if questionnaire_parts_id_str %}
                                                <button type="button" id="question_create_btn" class="my-btn my-btn-egypt-1 my-btn-w7" onclick="window.location.href='{% url 'training:questionnaire_register' questionnaire_parts_id_str %}'"><span class="my_btn_text">はい</span></button>
                                            {% endif %}

                                        </div>
                                    {% comment %} </div><!-- /.modal-body --> {% endcomment %}
                                    </div><!-- /.modal-footer -->

                                </div><!-- /.modal-content -->

                            </div><!-- /.modal-dialog -->

                        </div><!-- /.modal -->

                        <!-- ボタン有効化制御の設定確認モーダル -->
                        <div class="modal" data-keyboard="false" data-backdrop="static" id="btn_activate_ctl_register_modal" tabindex="-1">

                            <div class="modal-dialog modal-dialog-centered">

                                <div class="modal-content">

                                    <div class="modal-header">
                                        <h5 class="modal-title" id="mypartsModalLabel" style="font-weight: bold; text">ボタン有効化制御の設定</h5>
                                        {% if training.pk %}
                                            <button type="button" class="close" data-dismiss="modal" aria-label="閉じる" onclick="window.location.href='{% url 'training:cancel_button_activate_ctl_register' training.pk %}'">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        {% endif %}
                                    </div><!-- /.modal-header -->

                                    <div class="modal-body">
                                        <h5 class="text-center m-0 p-3">続けてボタン有効化制御の設定を行いますか？</h5>
                                    </div><!-- /.modal-body -->

                                    <div class="modal-footer justify-content-center">

                                        <!-- ボタン -->
                                        {% comment %} <div class="d-flex justify-content-center btns"> {% endcomment %}
                                        <div class="btn_group">

                                            {% if training.pk %}
                                                <!-- トレーニング管理画面へ遷移　バックエンドでセッションを削除 -->
                                                <button type="button" id="" class="my-btn my-btn-gray-2 my-btn-w7 mr-3" data-dismiss="modal" onclick="window.location.href='{% url 'training:cancel_button_activate_ctl_register' training.pk %}'"><span class="my_btn_text">いいえ</span></button>
                                                <!-- ボタン有効化制御の設定画面へ遷移 -->
                                                <button type="button" id="btn_activate_ctl_register_btn" class="my-btn my-btn-egypt-1 my-btn-w7" onclick="window.location.href='{% url 'training:button_activate_ctl' training.pk %}'"><span class="my_btn_text">はい</span></button>
                                            {% endif %}

                                        </div>

                                    {% comment %} </div><!-- /.modal-body --> {% endcomment %}
                                    </div><!-- /.modal-footer -->

                                </div><!-- /.modal-content -->

                            </div><!-- /.modal-dialog -->

                        </div><!-- /.modal -->


                        <!-- トレーニングの複製モーダル -->
                        <div class="modal fade" id="training_copy_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">

                            <div class="modal-dialog modal-dialog-centered">

                                <div class="modal-content">

                                    <div class="modal-header">

                                        <h5 class="modal-title" id="myModalLabel" style="font-weight: bold; text">トレーニングの複製確認</h5>

                                        <button type="button" class="close" data-dismiss="modal" aria-label="閉じる">
                                            <span aria-hidden="true">&times;</span>
                                        </button>

                                    </div>

                                    <div class="modal-body">

                                        <h6><i class="fas fa-exclamation-circle" style="color: #dc3e45;"></i>「{{ training.title }}」を複製しますか？</h6>

                                    </div>

                                    <div class="modal-footer justify-content-center">

                                        <form action="{% url 'training:training_copy' training.id %}" method="POST" id="training_copy-form">

                                            {% csrf_token %}

                                            <div class="btn_group">
                                                <button type="button" class="my-btn my-btn-gray-2 my-btn-w7 mr-3" data-dismiss="modal">閉じる</button>
                                                <button type="submit" class="my-btn my-btn-egypt-1 my-btn-w7">複製する</button>
                                            </div>

                                        </form>

                                    </div><!-- /.modal-footer -->

                                </div><!-- /.modal-content -->

                            </div><!-- /.modal-card -->

                        </div><!-- /.modal -->


                        <!-- ゲストユーザーにトレーニングを紐づけるモーダル -->
                        {% comment %} <div class="modal fade" id="guest_user_link_modal" tabindex="-1" aria-labelledby="exampleModalLabel">

                            <div class="modal-dialog modal-xl modal-dialog-centered">

                                <div class="modal-content">

                                    <div class="modal-header">
                                        <h5 class="modal-title" id="exampleModalLabel" style="font-weight: bold; text">ゲストユーザー紐づけ確認</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="閉じる">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>

                                    <div class="modal-body">

                                        <p style="font-size: 16px;">・トレーニングを紐づけるゲストユーザーを選択してください。</p>

                                        <form method="POST" enctype='multipart/form-data' id="guest_user_link_form">
                                            {% csrf_token %}

                                            {% for field in form %}
                                                {{ field }}
                                            {% endfor %}

                                        </from>

                                    </div>

                                    <div class="modal-footer justify-content-center">

                                        <div class="btn_group">
                                            <button type="button" class="my-btn my-btn-gray-1 my-btn-w8 mr-3" data-dismiss="modal">閉じる</button>
                                            <button type="submit" id="guest_user_link_add_btn" class="my-btn my-btn-egypt-1 my-btn-w8 mr-3"><span class="my_btn_text">紐づける</span></button>
                                        </div>

                                    </div><!-- /.modal-footer -->

                                </div><!-- /.modal-content -->

                            </div><!-- /.modal-dialog -->

                        </div><!-- /.modal --> {% endcomment %}




                    {% endfor %}


                </div>


            </div>



            <!-- ボタン -->
            <div class="d-flex justify-content-center btn-grp">

                <!-- 前のページに戻る -->
                <button type="button" class="my-btn return_btn my-btn-egypt-1 my-btn-w12" onclick="window.location.href='{% url 'training:training_change_management_all' %}'"><span class="my_btn_text">前のページに戻る</span></button>

            </div>


            <!--　パーツ追加モーダルの設定 -->
            <div class="modal fade" id="parts_add_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">

                <div class="modal-dialog modal-dialog-centered">

                    <div class="modal-content">

                        <div class="modal-header">

                            <h5 class="modal-title" id="myModalLabel" style="font-weight: bold;">パーツを追加する</h5>

                            <button type="button" class="close" data-dismiss="modal" aria-label="閉じる">
                                <span aria-hidden="true">&times;</span>
                            </button>

                        </div>

                        <div class="modal-body">

                            <p style="font-size: 16px; text-align: center;">追加するパーツを選択してください。</p>


                            <div class="items">
                                <!-- テスト -->
                                <div class="parts_test" onclick="window.location.href='{% url 'training:test_parts_create' training.id %}'"></div>
                                <!-- アンケート -->
                                <div class="parts_questionnaire" onclick="window.location.href='{% url 'training:questionnaire_parts_create' training.id %}'"></div>
                                <!-- ファイルアップロード -->
                                <div class="parts_file_uplord" style="pointer-events: none; opacity: 0.5;"></div>
                                <!-- 動画 -->
                                <div class="parts_movie" onclick="window.location.href='{% url 'training:movie_parts_create' training.id %}'"></div>
                                <!-- 投票 -->
                                <div class="parts_vote" style="pointer-events: none; opacity: 0.5;"></div>
                                <!-- ファイルDL -->
                                <div class="parts_file_downlord" onclick="window.location.href='{% url 'training:file_parts_create' training.id %}'"></div>
                            </div>

                        </div>

                        <div class="modal-footer justify-content-center">

                            <form action="{% url 'training:training_delete' training.id %}" method="POST" id="delete-form">

                                {% csrf_token %}

                                <div class="">
                                    {% comment %} <button type="submit" class="my-btn my-btn-egypt-1  my-btn-w7 mr-3">追加</button> {% endcomment %}
                                    <button type="button" class="my-btn my-btn-gray-2 my-btn-w7" data-dismiss="modal">閉じる</button>

                                </div>

                            </form>

                        </div><!-- /.modal-footer -->

                    </div><!-- /.modal-content -->

                </div><!-- /.modal-card -->

            </div><!-- /.modal -->




            <!-- 削除モーダルの設定 トレーニング -->
            <div class="modal fade" id="training_delete_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">

                <div class="modal-dialog modal-dialog-centered">

                    <div class="modal-content">

                        <div class="modal-header">

                            <h5 class="modal-title" id="myModalLabel" style="font-weight: bold; text">トレーニングの削除確認</h5>

                            <button type="button" class="close" data-dismiss="modal" aria-label="閉じる">
                                <span aria-hidden="true">&times;</span>
                            </button>

                        </div>

                        <div class="modal-body">

                            <h6><i class="fas fa-exclamation-circle" style="color: #dc3e45;"></i>「{{ training.title }}」を削除しますか？</h6>

                        </div>

                        <div class="modal-footer justify-content-center">

                            <form action="{% url 'training:training_delete' training.id %}" method="POST" id="delete-form">

                                {% csrf_token %}

                                <div class="btn_group">
                                    <button type="button" class="my-btn my-btn-gray-2 my-btn-w7 mr-3" data-dismiss="modal">閉じる</button>
                                    <button type="submit" class="my-btn my-btn-egypt-1 my-btn-w7">削除</button>
                                </div>

                            </form>

                        </div><!-- /.modal-footer -->

                    </div><!-- /.modal-content -->

                </div><!-- /.modal-card -->

            </div><!-- /.modal -->


            <!-- ゲストユーザーにトレーニングを紐づけるモーダル -->
            <div class="modal fade" id="guest_user_link_modal" tabindex="-1" aria-labelledby="exampleModalLabel">

                <div class="modal-dialog modal-xl modal-dialog-centered">

                    <div class="modal-content">

                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel" style="font-weight: bold; text">ゲストユーザー紐づけ確認</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="閉じる">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>

                        <div class="modal-body">

                            <p style="font-size: 16px;">・トレーニングを紐づけるゲストユーザーを選択してください。</p>

                            <form method="POST" enctype='multipart/form-data' id="guest_user_link_form">
                                {% csrf_token %}

                                {% for field in form %}
                                    {{ field }}
                                {% endfor %}

                            </from>

                        </div>

                        <div class="modal-footer justify-content-center">

                            <div class="btn_group">
                                <button type="button" class="my-btn my-btn-gray-1 my-btn-w8 mr-3" data-dismiss="modal">閉じる</button>
                                <button type="submit" id="guest_user_link_add_btn" class="my-btn my-btn-egypt-1 my-btn-w8 mr-3"><span class="my_btn_text">紐づける</span></button>
                            </div>

                        </div><!-- /.modal-footer -->

                    </div><!-- /.modal-content -->

                </div><!-- /.modal-dialog -->

            </div><!-- /.modal -->













            {% endwith %}
            {% endwith %}
            {% endwith %}

        {% endfor %}

    </div>
</div>












{% endblock %}

{% block extra_js %}

    <!----- Bootstrap duallistbox ------>
    {% comment %} <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap4-duallistbox/4.0.2/jquery.bootstrap-duallistbox.js"></script> {% endcomment %}
    <script type="text/javascript" src="{% static 'training/js/jquery.bootstrap-duallistbox.js' %}"></script>


<script>
    // 5秒後にエラーメッセージを消す関数
    $('.messages').fadeIn("slow", function () {
        //コールバックで5秒後にフェードアウト
        $(this).delay(5000).fadeOut("slow");
    });
</script>

<script>
    /////////////////////
    // ツールチップ     //
    /////////////////////
    $('[data-toggle="tooltip"]').tooltip()
</script>


<script>

$(function () {

    // 配布ファイルのダウンロードを取得
    {% comment %} $('.file_download a').on('click', function() {
        var is_type = "single"
        var file_id = $(this).attr('id');
        var parts_id = $(this).data('parts_id');

        // 送信データとして保存
        var data = { 'file_id': file_id, 'parts_id': parts_id, 'is_type': is_type};

        console.log("aaaa")

        $.ajax({
            type: 'POST',
            url: "{% url 'training:file_download_status' %}",
            data: data,
            dataType: 'json',
            success: function(data){
                if(data.status=='ok'){
                    //alert(data.message)
                    //window.location.href = '/';
                }else{
                    //alert(data.message)
                }
            }
        });
    });



    // 配布ファイルのダウンロードを取得
    $('.zip_download').on('click', function() {
        var is_type = "multiple"
        var file_id = $(this).attr('id');
        var parts_id = $(this).data('parts_id');

        // 送信データとして保存
        var data = { 'file_id': file_id, 'parts_id': parts_id, 'is_type': is_type};


        console.log("bbb")

        $.ajax({
            type: 'POST',
            url: "{% url 'training:file_download_status' %}",
            data: data,
            dataType: 'json',
            success: function(data){
                if(data.status=='ok'){
                    alert(data.message)
                    //console.log('#' + file_id > ".download_status")
                    //console.log($(this))
                    window.location.href = '/';
                }else{
                    alert(data.message)
                }
            }
        });
    }); {% endcomment %}

    /////////////////////
    // 有効期限の表示    //
    /////////////////////
    $('.period_rem_date').each(function(){

        // 現在日時
        var current = new Date();

        // 期限(文字列)
        period_date_str = $(this).data('period_date')
        console.log("期限ストリング")
        console.log(period_date_str)
        // 期限
        var period_date = new Date( period_date_str )
        // 公開日時ミリ秒
        var period_date = period_date.getTime();

        // 日付差分
        var diff_date =  period_date - current

        // 日に変換
        var rem_day = Math.floor(diff_date / (1000 * 60 * 60 *24));
        console.log("rem_day", rem_day)

        // 日に1日を加算
        var rem_day_add = rem_day + 1;
        console.log("日に1日を加算")
        console.log(rem_day_add)
        // 2日以下の場合は赤
        if (rem_day_add <= 2) {
        $(this).css("color", "#ff0000");

        // 6日以下の場合は黄色
        } else if (rem_day_add <= 6) {
        $(this).css("color", "#ffa500");

        // それ以外は青
        } else {
        $(this).css("color", "#0000ff");
        }

        // 30日以上の場合は一ヶ月以上と表示
        if (rem_day_add >= 30) {
        $(this).text("残り30日以上");

        } else if (rem_day_add < 0) {
        $(this).text("期限切れ");

        // それ以外は日数を表示
        } else {
        // 残り時間を表示
        $(this).text("残り" + rem_day_add + "日");
        }

        // // 中央揃え
        // $(this).css("text-align", "center");

    });


    /////////////////////
    // 有効期限の表示    //
    /////////////////////
    // $('.top_period_rem_date').each(function(){

        // 現在日時
        //  var current = new Date();

        // 期限(文字列)
        // period_date_str = $(this).data('period_date')
        // 期限
        // var period_date = new Date( period_date_str )
        // 公開日時ミリ秒
        // var period_date = period_date.getTime();

        // 日付差分
        // var diff_date =  period_date - current

        // 日に変換
        // var rem_day = Math.floor(diff_date / (1000 * 60 * 60 *24));

        // 日に1日を加算
        // var rem_day_add = rem_day + 1;
        // 2日以下の場合は赤
        // if (rem_day_add <= 2) {
        //$(this).css("color", "#ff0000");

        // 6日以下の場合は黄色
        // } else if (rem_day_add <= 6) {
        //$(this).css("color", "#ffa500");

        // それ以外は青
        // } else {
        //$(this).css("color", "#0000ff");
        //}

        // 30日以上の場合は一ヶ月以上と表示
        // if (rem_day_add >= 30) {
        // $(this).text("残り30日以上");

        // } else if (rem_day_add < 0) {
        // $(this).text("期限切れ");

        // それ以外は日数を表示
        // } else {
        // 残り時間を表示
        // $(this).text("残り" + rem_day_add + "日");
        // }

        // // 中央揃え
        // $(this).css("text-align", "center");

    // });

    /////////////////////
    // ボタンの有効・無効 //
    /////////////////////



    ///////////////////
    // Newラベルの表示 //
    ///////////////////
    $('.new').each(function(){
        // 現在日時
        var current = new Date();
        // 6時間前のミリ秒を取得
        var range = current - (6 * 60 * 60 * 1000);
        // 作成日時(文字列)
        created_date_str = $(this).data('created_time')
        // 作成日時
        var created_date = new Date( created_date_str )
        // 作成日時ミリ秒
        var created_date_ms = created_date.getTime();
        // 作成日が、６時間前の時間を超えたら非表示
        if (range > created_date_ms){
            $(this).css("display", "inline-block");
        }else{
            $(this).css("display", "none");
        }
    });


});

</script>


<script>
    ///////////////////
    // モーダルの表示 //
    ///////////////////

    $(function () {

        // セッションを受け取る
        var question_register_done = "{{ request.session.question_register_done }}"
        console.log("----------------------テスト", question_register_done)

        // question_register_doneがある場合
        if(question_register_done!=''){

            console.log('セッションが存在する');

            // モーダル表示
            $('#question_register_modal').modal('show')

        } else {
            console.log('存在しない');

            // モーダル非表示
            $('#question_register_modal').modal('hide')

        }


        // アンケートの設問作成
        // セッションを受け取る
        var questionnaire_register_done = "{{ request.session.questionnaire_register_done }}"
        console.log("----------------------アンケート", questionnaire_register_done)

        // question_register_doneがある場合
        if(questionnaire_register_done!=''){

            // モーダル表示
            $('#questionnaire_register_modal').modal('show')

        } else {
            // モーダル非表示
            $('#questionnaire_register_modal').modal('hide')

        }

        // ボタン有効化制御の設定
        // セッションを受け取る
        var parts_delete_done = "{{ request.session.parts_delete_done }}"
        console.log("----------- パーツ削除", parts_delete_done)

        // question_register_doneがある場合
        if(parts_delete_done!=''){

            console.log('セッションが存在する');

            // モーダル表示
            $('#btn_activate_ctl_register_modal').modal('show')

        } else {
            console.log('存在しない');

            // モーダル非表示
            $('#btn_activate_ctl_register_modal').modal('hide')

        }

    });

</script>


<script>
    // -----------------
    // bootstrap-duallistbox
    // -----------------
    var demo1 = $('select[name="guest_user_name"]').bootstrapDualListbox({
        moveOnSelect: true,
        filterTextClear:'全件表示',
        filterPlaceHolder:'検索',
        nonSelectedListLabel: 'ゲストユーザー一覧',
        selectedListLabel: '選択済みゲストユーザー一覧',
        preserveSelectionOnMove: 'moved',
        moveAllLabel: '選択済みに全て移動',
        removeAllLabel: '選択を全て解除',
        infoText:'{0}件',
        infoTextEmpty:'0件',
        infoTextFiltered:'{1}件中{0}件表示',

    });

    // 共同管理者権限 移動アイコン変更
    $(function() {
        var customSettings = $('select[name="is_staff"]').bootstrapDualListbox('getContainer');
        // >>を削除
        customSettings.find('.moveall').text('');
        customSettings.find('.moveall').append('<i class="fas fa-long-arrow-alt-right"></i> <i class="fas fa-long-arrow-alt-right"></i>')
        // <<を削除
        customSettings.find('.removeall').text('');
        customSettings.find('.removeall').append('<i class="fas fa-long-arrow-alt-left"></i> <i class="fas fa-long-arrow-alt-left"></i>')

    });

</script>




{% endblock %}